<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Raritan PX2/PX3 JSON-RPC API: Event Rules and Actions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Raritan PX2/PX3 JSON-RPC API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Interfaces</span></a></li>
      <li><a href="files.html"><span>IDL&#160;Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Event Rules and Actions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Event rules and actions are configured with the <b>EventEngine</b> interface at the well-known URI <code>/event_engine</code>. Event rules select a subset of possible events and define one or more actions that should be executed for once for each matching event. Supported event actions include sending SNMP traps or emails, switching outlets or raising alarms.</p>
<h2>Event Rules</h2>
<p>Event rules are managed with the <b>listRules</b>, <b>addRule</b>, <b>modifyRule</b>, <b>enableRule</b>, <b>disableRule</b> and <b>deleteRule</b> methods. Rules connect a trigger condition (a subset of possible events) with one or more actions.</p>
<dl class="section note"><dt>Note</dt><dd>The IDL interface was designed for defining complex rules that perform logical operations to combine multiple event conditions. However, as of now this is not supported by the firmware. Event rules can only have a single trigger conditions, possibly using wildcards to select entire subtrees.</dd></dl>
<p>Events are organized in a hierarchical structure and identified by path. Event IDs can contain dynamic components like user names, outlet numbers or sensor types. Event IDs can contain the wildcard <code>*</code> to match an aribtrary value for a single path element, or end with the <code>**</code> wildcard to select a complete subtree of events. The list of supported event conditions strongly depends on the device model and configuration. The easiest way to find the event ID for a particular event is to configure a rule in the web GUI and then inspect it with JSON-RPC.</p>
<p>A few examples for event IDs are:</p>
<ul>
<li><code>Device.SystemStartup</code>: Emitted after the device firmware has booted</li>
<li><code>UserActivity.admin.LoggedIn</code>: The <code>admin</code> user has logged in</li>
<li><code>Inlet.I1.Sensor.current.AboveUpperWarning</code>: The inlet current reading exceeds the upper warning threshold</li>
<li><code>Outlet.*.PowerControl.**</code>: Any outlet has been switched or power-cycled</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># Python example: Create a rule to invoke user-defined action &#39;Action_001&#39; when</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"># any user logs in</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">from</span> raritan.rpc <span class="keyword">import</span> event</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;event_engine = event.Engine(<span class="stringliteral">&quot;/event_engine&quot;</span>, agent)</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;condition = event.Engine.Condition(</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    negate = <span class="keyword">False</span>,                                        <span class="comment"># ignored</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    operation = event.Engine.Condition.Op.AND,             <span class="comment"># ignored</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    matchType = event.Engine.Condition.MatchType.ASSERTED, <span class="comment"># only login, not logout</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    eventId = [ <span class="stringliteral">&quot;UserActivity&quot;</span>, <span class="stringliteral">&quot;*&quot;</span>, <span class="stringliteral">&quot;LoggedIn&quot;</span> ],</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    conditions = []                                        <span class="comment"># ignored</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;rule = event.Engine.Rule(</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    id = <span class="stringliteral">&quot;&quot;</span>,                         <span class="comment"># assigned upon successful creation</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    name = <span class="stringliteral">&quot;Any user has logged in&quot;</span>,</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    isSystem = <span class="keyword">False</span>,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    isEnabled = <span class="keyword">True</span>,</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    isAutoRearm = <span class="keyword">True</span>,              <span class="comment"># ignored</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    hasMatched = <span class="keyword">False</span>,              <span class="comment"># ignored</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    condition = condition,</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    actionIds = [ <span class="stringliteral">&quot;Action_001&quot;</span> ],</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    arguments = []</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;ret, rule_id = event_engine.addRule(rule)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keywordflow">if</span> ret != 0:</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    print(<span class="stringliteral">&quot;Creating rule failed, error code %d&quot;</span> % ret)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordflow">else</span>:</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    print(<span class="stringliteral">&quot;Rule created successfully, new rule id: %s&quot;</span> % rule_id)</div></div><!-- fragment --><h2>Event Actions</h2>
<p>Event actions define what to do in case an emitted event matches a rule. There are many types of actions, all with specific configuration parameters. Action parameters are specified as key-value pairs in the <b>arguments</b> vector.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># Python example: Create action to send out an email notification</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">from</span> raritan.rpc <span class="keyword">import</span> event</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;event_engine = event.Engine(<span class="stringliteral">&quot;/event_engine&quot;</span>, agent)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;action = event.Engine.Action(</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    id = <span class="stringliteral">&quot;&quot;</span>, <span class="comment"># assigned upon successful creation</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    name = <span class="stringliteral">&quot;Send mail to admin&quot;</span>,</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    isSystem = <span class="keyword">False</span>,</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    type = <span class="stringliteral">&quot;SendSmtpMessage&quot;</span>,</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    arguments = [</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <a class="code" href="structevent_1_1KeyValue.html">event.KeyValue</a>(<span class="stringliteral">&quot;Recipient1&quot;</span>, <span class="stringliteral">&quot;admin@organization.example&quot;</span>),</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <a class="code" href="structevent_1_1KeyValue.html">event.KeyValue</a>(<span class="stringliteral">&quot;OverrideSmtp&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>),</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <a class="code" href="structevent_1_1KeyValue.html">event.KeyValue</a>(<span class="stringliteral">&quot;UseCustomMessage&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>),</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <a class="code" href="structevent_1_1KeyValue.html">event.KeyValue</a>(<span class="stringliteral">&quot;CustomMessage&quot;</span>, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    ]</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;ret, action_id = event_engine.addAction(action)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keywordflow">if</span> ret != 0:</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    print(<span class="stringliteral">&quot;Creating action failed, error code %d&quot;</span> % ret)</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keywordflow">else</span>:</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    print(<span class="stringliteral">&quot;Action created successfully, new action id: %s&quot;</span> % action_id)</div></div><!-- fragment --><p>The following sections list the most important action types and their parameters. The list is not complete; check the web GUI to see all supported actions.</p>
<h3>Execute an Action Group (Action Type: "ActionGroup")</h3>
<p>Executes up to 32 other actions</p>
<ul>
<li><b>Action1</b> .. <b>Action32:</b> IDs of actions to execute</li>
</ul>
<h3>Raise and Alarm (Action Type: "Alarm")</h3>
<p>Supported action types for notification and acknowledgment actions: <code>SendSmtpMessage</code>, <code>SendSyslogMessage</code>, <code>SmsMessage</code>, <code>ExternalBeeper</code>, <code>SwitchBuzzer</code>.</p>
<ul>
<li><b>AlarmNotfActions:</b> IDs of notification actions, separated by semicolons</li>
<li><b>AlarmReNotfEnabled:</b> Enable re-scheduling of alarm notifications ("true"/"false")</li>
<li><b>AlarmReNotfPeriod:</b> Re-scheduling period in minutes (1..1440)</li>
<li><b>AlarmReNotfMaxNum:</b> Re-scheduling limit (1..1000, -1 for unlimited)</li>
<li><b>AlarmAckActions:</b> IDs of acknowledgement notification actions, separated by semicolons</li>
</ul>
<h3>Enable/Disable PDU Load Shedding (Action Type: "SetPduLoadShedding")</h3>
<ul>
<li><b>Operation:</b> "on" to enable load shedding, "off" to disable it.</li>
</ul>
<h3>Log Event Message (Action Type: "LogEventMessage")</h3>
<p>This action has no parameters.</p>
<h3>Send Email (Action Type: "SendSmtpMessage")</h3>
<ul>
<li><b>Recipient:</b> Recipient email address</li>
<li><b>OverrideSmtp:</b> "1" to use custom SMTP server, "0" to use the default server</li>
<li><b>UseCustomMessage:</b> "1" to use a custom mail text</li>
<li><b>CustomMessage:</b> Custom message text for notification message</li>
</ul>
<p>The following parameters are only required if <b>OverrideSmtp</b> is set to "1":</p>
<ul>
<li><b>SmtpHost:</b> SMTP server name</li>
<li><b>SmtpPort:</b> SMTP server port</li>
<li><b>SmtpFrom:</b> SMTP sender mail address</li>
<li><b>SmtpRetryCount:</b> Number of sending retries (0..10)</li>
<li><b>SmtpRetryInterval:</b> Retry interval in minutes (1..60)</li>
<li><b>SmtpUseAuth:</b> "1" to use authentication, "0" otherwise</li>
<li><b>SmtpUsername:</b> SMTP user name</li>
<li><b>SmtpPassword:</b> SMTP password</li>
<li><b>SmtpUseTls:</b> "1" to enable SMTP over TLS (StartTLS)</li>
<li><b>SmtpCaCertChain:</b> CA certificate (TLS only)</li>
<li><b>SmtpAllowOffTimeRangeCerts:</b> "1" to allow certificates outside of their validity period</li>
</ul>
<h3>Send SNMP Notification (Action Type: "SendSnmpTrap")</h3>
<ul>
<li><b>SnmpNotfType:</b> Notification type. One of "v2Trap", "v2Inform", "v3Trap", "v3Inform"</li>
<li><b>SnmpTrapDest1:</b> Primary trap destination, format: "&lt;host&gt;:&lt;port&gt;:&lt;community&gt;"</li>
<li><b>SnmpTrapDest2:</b> Optional second destination (SNMPv2 only)</li>
<li><b>SnmpTrapDest3:</b> Optional third destination (SNMPv2 only)</li>
<li><b>SnmpNotfTimeout:</b> Timeout in seconds for SNMPv2/SNMPv3 informs</li>
<li><b>SnmpNotfRetries:</b> Number of retries for SNMPv2/SNMPv3 informs</li>
<li><b>SnmpNotfV3SecName:</b> SNMPv3 security/user name</li>
<li><b>SnmpNotfV3SecLevel:</b> SNMPv3 security level. One of: "noAuthNoPriv", "authNoPriv", "authPriv"</li>
<li><b>SnmpNotfV3AuthProto:</b> SNMPv3 authentication protocol. One of: "md5", "sha"</li>
<li><b>SnmpNotfV3AuthKey:</b> SNMPv3 authentication passphrase</li>
<li><b>SnmpNotfV3PrivProto:</b> SNMPv3 privacy protocol. One of: "des", "aes"</li>
<li><b>SnmpNotfV3PrivKey:</b> SNMPv3 privacy passphrase</li>
</ul>
<h3>Send Syslog Message (Action Type: "SendSyslogMessage")</h3>
<ul>
<li><b>SyslogServerName:</b> Syslog server name</li>
<li><b>SyslogServerUseTcp:</b> "1" to use TCP instead of UDP</li>
<li><b>SyslogServerUseTls:</b> "1" to use TLS encryption (TCP only)</li>
<li><b>SyslogServerNoBsdCompat:</b> "0" to use legacy BSD protocol (UDP only)</li>
<li><b>SyslogServerPort:</b> Syslog server UDP port</li>
<li><b>SyslogServerTcpPort:</b> Syslog server TCP port</li>
<li><b>SyslogServerTlsPort:</b> Syslog server TCP+TLS port</li>
<li><b>SyslogServerCaCertChain:</b> CA certiicate (TLS only)</li>
<li><b>SyslogServerAllowOffTimeRangeCerts:</b> "1" to allow certificates outside of their validity period</li>
</ul>
<h3>Send SMS Message (Action Type: "SmsMessage")</h3>
<ul>
<li><b>Destination:</b> Recipient phone number</li>
<li><b>UseCustomMessage:</b> "1" to use a custom SMS text</li>
<li><b>CustomMessage:</b> Custom message text for SMS</li>
</ul>
<h3>Internal Beeper (Action Type: "SwitchBuzzer")</h3>
<ul>
<li><b>Operation:</b> "on" to enable beeper", "off" to disable it</li>
</ul>
<h3>Switch Outlets (Action Type: "SwitchOutlet")</h3>
<ul>
<li><b>Operation:</b> One of "on", "off", "cycle"</li>
<li><b>OutletIndex:</b> Zero-based outlet index</li>
</ul>
<h3>Switch Peripheral Actuator (Action Type: "SwitchPeripheralActuator")</h3>
<ul>
<li><b>Operation:</b> One of "on", "off", "cycle"</li>
<li><b>SlotIndex:</b> Zero-based peripheral device slot index </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 5 2017 19:14:41 for Raritan PX2/PX3 JSON-RPC API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
